<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>·ªû ƒë√¢y c√≥ s·ª± b√¨nh y√™n - S·ª©c Kh·ªèe T√¢m Th·∫ßn cho Th·∫ø H·ªá Z</title>
  
  <!-- Th√™m Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- C·∫•u h√¨nh Tailwind CSS cho ch·∫ø ƒë·ªô t·ªëi d·ª±a tr√™n l·ªõp -->
  <script>
    // ƒê·∫£m b·∫£o r·∫±ng Tailwind CSS ƒë√£ ƒë∆∞·ª£c t·∫£i tr∆∞·ªõc khi c·∫•u h√¨nh
    window.addEventListener('DOMContentLoaded', () => {
      tailwind.config = {
        darkMode: 'class', // Thi·∫øt l·∫≠p ch·∫ø ƒë·ªô t·ªëi d·ª±a tr√™n l·ªõp
        theme: {
          extend: {},
        },
        plugins: [],
      }
    });
  </script>

  <script>
    function isMobileDevice() {
      return /Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    }

    document.addEventListener('DOMContentLoaded', function() {
      if (isMobileDevice()) {
        document.body.classList.add('desktop-like');
      }
    });
  </script>


  <!-- Th√™m Font Awesome cho c√°c bi·ªÉu t∆∞·ª£ng -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  
  <style>
    /* Removed duplicate .advice-box styles */

    /* ƒêƒ©a than xoay cho podcast */
    .vinyl {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      border: 10px solid #fff;
      background-color: #333;
      position: relative;
      animation: spin-vinyl 4s linear infinite;
      transform-origin: center center;
    }

    .vinyl::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 30px;
      height: 30px;
      background-color: #fff;
      border-radius: 50%;
      transform: translate(-50%, -50%);
    }

    @keyframes spin-vinyl {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    /* N√∫t d·ª´ng/ph√°t */
    .stop-button {
      width: 40px;
      height: 40px;
      background-color: red; /* Thay ƒë·ªïi m√†u n·ªÅn th√†nh ƒë·ªè */
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
      position: absolute;
      top: 80px;
      left: 50%;
      transform: translateX(-50%);
      transition: background-color 0.3s ease;
    }

    .stop-button:hover {
      background-color: darkred; /* Thay ƒë·ªïi m√†u n·ªÅn khi hover n·∫øu mu·ªën */
    }

    /* CSS cho khung chat */
    #chatWindow {
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      max-height: 300px;
      padding: 10px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
    }

    .chat-bubble {
      max-width: 70%;
      word-wrap: break-word;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 10px;
    }

    .chat-bubble-self {
      align-self: flex-end;
      background-color: #4ade80; /* Green-400 */
      color: white;
    }

    .chat-bubble-other {
      align-self: flex-start;
      background-color: #3b82f6; /* Blue-500 */
      color: white;
    }

    /* Loading Spinner Styles */
    .loader {
      border-top-color: #3498db;
      animation: spin-loader 1s infinite linear;
    }
    @keyframes spin-loader {
      to { transform: rotate(360deg); }
    }

    /* Dark Mode Specific Styles */
    .dark {
      background-color: #121212;
      color: #ffffff;
    }
    .dark .bg-white {
      background-color: rgba(255, 255, 255, 0.1) !important;
    }
    .dark .text-white {
      color: #ffffff !important;
    }
    .dark .bg-opacity-10 {
      background-color: rgba(255, 255, 255, 0.1) !important;
    }
    .dark .bg-opacity-20 {
      background-color: rgba(255, 255, 255, 0.2) !important;
    }
    .dark .bg-gradient-to-br.from-pink-300 {
      background: linear-gradient(to bottom right, #333, #444) !important;
    }

    /* N√∫t chuy·ªÉn ng√¥n ng·ªØ */
    .lang-switch {
      position: absolute;
      top: 20px;
      right: 20px;
      background-color: rgba(255, 255, 255, 0.5);
      color: #000;
      font-weight: bold;
      padding: 10px 20px;
      border-radius: 30px;
      cursor: pointer;
      z-index: 100;
      transition: background-color 0.3s, color 0.3s;
    }

    /* N√∫t chuy·ªÉn ch·∫ø ƒë·ªô t·ªëi */
    .dark-mode-toggle {
      position: absolute;
      top: 20px;
      right: 150px;
      background-color: rgba(255, 255, 255, 0.5);
      color: #000;
      font-weight: bold;
      padding: 10px 20px;
      border-radius: 30px;
      cursor: pointer;
      z-index: 100;
      transition: background-color 0.3s, color 0.3s;
    }

    /* Additional Styles for Advice Boxes and Chat */
    .advice-box {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s, background 0.3s;
    }

    .advice-box:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.1));
    }
  </style>

</head>
<body class="bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 dark:from-gray-800 dark:via-gray-700 dark:to-gray-900 min-h-screen flex flex-col items-center justify-center p-4 transition-colors duration-500">
  <!-- N√∫t chuy·ªÉn ng√¥n ng·ªØ -->
  <button class="lang-switch bg-white bg-opacity-50 dark:bg-gray-700 dark:text-white text-black font-bold py-2 px-4 rounded-full transition-colors duration-300" id="langSwitch">English</button>

  <!-- N√∫t chuy·ªÉn ƒë·ªïi ch·∫ø ƒë·ªô t·ªëi -->
  <button class="dark-mode-toggle bg-white bg-opacity-50 dark:bg-gray-700 dark:text-white text-black font-bold py-2 px-4 rounded-full cursor-pointer z-50 transition-colors duration-300" id="darkModeToggle">Dark Mode</button>
  
  <main class="bg-white bg-opacity-10 dark:bg-gray-800 dark:bg-opacity-20 backdrop-filter backdrop-blur-lg rounded-3xl shadow-2xl p-8 max-w-4xl w-full relative overflow-hidden transition-colors duration-500">
    <div class="absolute top-0 left-0 w-full h-full bg-gradient-to-br from-pink-300 via-purple-300 to-indigo-300 opacity-30 dark:from-gray-700 dark:via-gray-600 dark:to-gray-800 z-0"></div>
    <div class="relative z-10">
      <!-- Ti√™u ƒë·ªÅ trang -->
      <h1 class="text-5xl font-bold text-center mb-8 text-white animate-pulse" id="pageTitle">FOR YOU</h1>
      
      <!-- N√∫t "Quay l·∫°i" -->
      <button id="backButton" class="bg-white bg-opacity-20 hover:bg-opacity-35 dark:bg-gray-600 dark:hover:bg-gray-500 text-white font-bold py-3 px-6 rounded-full transition-all duration-300 hidden mx-auto mb-8 transform hover:scale-105 shadow-lg hover:shadow-xl active:scale-92 focus:outline-none focus:ring-2 focus:ring-white focus:ring-opacity-50">
        <i class="fas fa-arrow-left mr-2"></i><span id="backText">Quay l·∫°i</span>
      </button>

      <!-- C√¢u h·ªèi c·∫£m x√∫c -->
      <p id="howAreYouText" class="text-2xl text-center mb-12 text-white">H√¥m nay b·∫°n c·∫£m th·∫•y th·∫ø n√†o?</p>
      
      <!-- C√°c n√∫t c·∫£m x√∫c -->
      <div class="grid grid-cols-2 md:grid-cols-5 gap-6" id="emoteButtons">
        <!-- N√∫t c·∫£m x√∫c Vui v·∫ª -->
        <button class="emote-btn bg-gradient-to-br from-yellow-300 to-yellow-500 hover:from-yellow-400 hover:to-yellow-600 dark:from-yellow-400 dark:to-yellow-600 transition-all duration-300 rounded-2xl transform hover:scale-105 hover:rotate-3" aria-label="Vui v·∫ª" data-emote="happy">
          <div class="w-full h-32 flex items-center justify-center text-6xl text-white">
            <i class="fas fa-smile animate-bounce"></i>
          </div>
          <span class="block py-2 text-lg font-semibold text-white" id="happyText">Vui v·∫ª</span>
        </button>
        
        <!-- N√∫t c·∫£m x√∫c Bu·ªìn -->
        <button class="emote-btn bg-gradient-to-br from-blue-300 to-blue-500 hover:from-blue-400 hover:to-blue-600 dark:from-blue-400 dark:to-blue-600 transition-all duration-300 rounded-2xl transform hover:scale-105 hover:rotate-3" aria-label="Bu·ªìn" data-emote="sad">
          <div class="w-full h-32 flex items-center justify-center text-6xl text-white">
            <i class="fas fa-sad-tear animate-pulse"></i>
          </div>
          <span class="block py-2 text-lg font-semibold text-white" id="sadText">Bu·ªìn</span>
        </button>
        
        <!-- N√∫t c·∫£m x√∫c T·ª©c gi·∫≠n -->
        <button class="emote-btn bg-gradient-to-br from-red-300 to-red-500 hover:from-red-400 hover:to-red-600 dark:from-red-400 dark:to-red-600 transition-all duration-300 rounded-2xl transform hover:scale-105 hover:rotate-3" aria-label="T·ª©c gi·∫≠n" data-emote="angry">
          <div class="w-full h-32 flex items-center justify-center text-6xl text-white">
            <i class="fas fa-angry animate-ping"></i>
          </div>
          <span class="block py-2 text-lg font-semibold text-white" id="angryText">T·ª©c gi·∫≠n</span>
        </button>
        
        <!-- N√∫t c·∫£m x√∫c S·ª£ h√£i -->
        <button class="emote-btn bg-gradient-to-br from-purple-300 to-purple-500 hover:from-purple-400 hover:to-purple-600 dark:from-purple-400 dark:to-purple-600 transition-all duration-300 rounded-2xl transform hover:scale-105 hover:rotate-3" aria-label="S·ª£ h√£i" data-emote="scared">
          <div class="w-full h-32 flex items-center justify-center text-6xl text-white">
            <i class="fas fa-flushed animate-spin"></i>
          </div>
          <span class="block py-2 text-lg font-semibold text-white" id="scaredText">S·ª£ h√£i</span>
        </button>
        
        <!-- N√∫t c·∫£m x√∫c CƒÉng th·∫≥ng -->
        <button class="emote-btn bg-gradient-to-br from-green-300 to-green-500 hover:from-green-400 hover:to-green-600 dark:from-green-400 dark:to-green-600 transition-all duration-300 rounded-2xl transform hover:scale-105 hover:rotate-3" aria-label="CƒÉng th·∫≥ng" data-emote="stressed">
          <div class="w-full h-32 flex items-center justify-center text-6xl text-white">
            <i class="fas fa-tired animate-pulse"></i>
          </div>
          <span class="block py-2 text-lg font-semibold text-white" id="stressedText">CƒÉng th·∫≥ng</span>
        </button>
      </div>
      
      <!-- N√∫t ƒëi·ªÅu h∆∞·ªõng ƒë·∫øn trang th∆∞ gi√£n -->
      <button id="relaxButton" class="bg-white bg-opacity-20 hover:bg-opacity-30 dark:bg-gray-600 dark:hover:bg-gray-500 text-white font-bold py-3 px-6 rounded-full transition-all duration-300 mt-8 transform hover:scale-105 shadow-lg hover:shadow-xl">
        <i class="fas fa-music mr-2"></i><span id="relaxText">Th∆∞ gi√£n ch√∫t kh√¥ng?</span>
      </button>
      
      <!-- Ph·∫ßn th∆∞ gi√£n -->
      <div id="relaxSection" class="hidden mt-12">
        <h2 class="text-4xl font-bold text-center mb-8 text-white animate-pulse" id="relaxTitle">B·∫°n h√£y nh·∫Øm m·∫Øt l·∫°i!</h2>
        <p class="text-2xl text-center mb-8 text-white" id="relaxDesc">Th∆∞ gi√£n v·ªõi podcast, nh·∫°c v√† s√°ch y√™u th√≠ch</p>
        
        <!-- Ch·ªânh s·ª≠a grid ƒë·ªÉ ph·∫ßn Spotify r·ªông ra -->
        <div class="grid grid-cols-1 gap-6">
          <!-- Khu v·ª±c Podcast v√† ƒê·ªçc S√°ch -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Khu v·ª±c Podcast v·ªõi ƒëƒ©a than xoay -->
            <div class="bg-white bg-opacity-20 dark:bg-gray-700 dark:bg-opacity-30 rounded-lg p-6 flex flex-col items-center">
              <h3 class="text-2xl font-bold mb-4 text-white" id="podcastTitle">Nghe Podcast</h3>
              <div class="vinyl relative">
                <div class="stop-button" id="podcastStopBtn"><i class="fas fa-play"></i></div>
              </div>
              <!-- Video podcast -->
              <video id="podcastVideo" controls class="hidden mt-4 w-full h-auto">
                <source src="https://rr2---sn-a5mlrnll.googlevideo.com/videoplayback?expire=1727616498&ei=kgH5Zuu4FsjartoPvZ3h4A4&ip=119.82.70.29&id=o-ANhp4iIrNuBmwHEbz6OZUSIc58YaZTYOR8X7d-eE00-A&itag=140&source=youtube&requiressl=yes&xpc=EgVo2aDSNQ%3D%3D&bui=AXLXGFTSmt9dHKnQ1SuXuhWu4G-3CCvQuabsV9Yea3QKrzFjkHOa_FoPkHH8OKAnBPjTya8sUucCVwoG&spc=54Mbxfkn4iSil9-YsaqhkXORvOuYBvyiFKdHCYBWvILAbX1J4mgk&vprv=1&svpuc=1&mime=audio%2Fmp4&ns=Tl3Vl3zw_edu5wz4gQlqVMMQ&rqh=1&gir=yes&clen=19284731&dur=1191.555&lmt=1694652472643320&keepalive=yes&fexp=24350518,24350557,51299152&c=WEB_CREATOR&sefc=1&txp=5432434&n=z2-ptu4H4Bm3jA&sparams=expire%2Cei%2Cip%2Cid%2Citag%2Csource%2Crequiressl%2Cxpc%2Cbui%2Cspc%2Cvprv%2Csvpuc%2Cmime%2Cns%2Crqh%2Cgir%2Cclen%2Cdur%2Clmt&sig=AJfQdSswRAIgOSFthjS4dcBdliNAtAR5-Qo25I_ltbGD6gAIiCTCsdUCIFK3cJyHaV1sRMoGabFHNSNuB7kG59HxFNebX4CR7mKj&redirect_counter=1&cm2rm=sn-qxae7z&rrc=80&req_id=13420c0c65dca3ee&cms_redirect=yes&cmsv=e&mh=jF&mip=183.91.22.22&mm=34&mn=sn-a5mlrnll&ms=ltu&mt=1727593991&mv=u&mvi=2&pl=21&lsparams=mh,mip,mm,mn,ms,mv,mvi,pl&lsig=ABPmVW0wRQIhALu8altfN4O_6Eu_UmIURabcN-49SgXadGyIs4KioEClAiB7IGguZownQwzf93tVNxhIhUV5Rs9AhslbB0g4qIeEOg%3D%3D" type="video/mp4">
                Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ th·∫ª video.
              </video>
              <span class="block py-2 text-lg font-semibold text-white text-center mt-4" id="podcastDesc">Podcast th∆∞ gi√£n</span>
            </div>

            <!-- Khu v·ª±c G·ª£i √Ω S√°ch -->
            <div class="bg-white bg-opacity-20 dark:bg-gray-700 dark:bg-opacity-30 rounded-lg p-6 flex flex-col items-center">
              <h3 class="text-2xl font-bold mb-4 text-white" id="bookTitle">ƒê·ªçc S√°ch Th∆∞ Gi√£n</h3>
              <ul class="list-disc list-inside text-white space-y-2 text-center">
                <li><a href="https://pubhtml5.com/gbwwc/ujjg/Nh%E1%BB%AFng_ng%C6%B0%E1%BB%9Di_kh%E1%BB%91n_kh%E1%BB%95/" target="_blank" class="text-blue-500 hover:text-blue-600 transition">S√°ch Th∆∞ Gi√£n 1</a></li>
                <li><a href="https://pubhtml5.com/pbty/libi/Y%C3%AAu_Nh%E1%BB%AFng_%C4%90i%E1%BB%81u_Kh%C3%B4ng_Ho%C3%A0n_H%E1%BA%A3o/" target="_blank" class="text-blue-500 hover:text-blue-600 transition">S√°ch Th∆∞ Gi√£n 2</a></li>
                <li><a href="https://pubhtml5.com/ntqa/vyts/Hi%E1%BB%83u_v%E1%BB%81_tr%C3%A1i_tim/" target="_blank" class="text-blue-500 hover:text-blue-600 transition">S√°ch Th∆∞ Gi√£n 3</a></li>
              </ul>
            </div>
          </div>

          <!-- Khu v·ª±c Nghe Nh·∫°c r·ªông -->
          <div class="bg-white bg-opacity-20 dark:bg-gray-700 dark:bg-opacity-30 rounded-lg p-6 flex flex-col items-center mt-6">
            <h3 class="text-2xl font-bold mb-4 text-white" id="musicTitle">Nghe nh·∫°c n√®</h3>
            <!-- Iframe Spotify -->
            <div class="w-full h-48 md:h-96 mb-4">
              <iframe src="https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO2EAUJs" width="100%" height="100%" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
            </div>
          </div>
        </div>
      </div>

      <!-- Ph·∫ßn c·∫£m x√∫c -->
      <div id="emotePage" class="hidden mt-12">
        <h2 id="emoteTitle" class="text-4xl font-bold text-center mb-8 text-white animate-pulse"></h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Ph·∫ßn t·∫°o b√†i vi·∫øt tr√™n di·ªÖn ƒë√†n -->
          <div id="forumSection" class="bg-white bg-opacity-20 dark:bg-gray-700 dark:bg-opacity-30 rounded-lg p-6">
            <h3 class="text-2xl font-bold mb-4 text-white" id="forumTitle">H√£y chia s·∫ª ƒë·∫øn ch√∫ng t√¥i</h3>
            <form id="forumForm" class="space-y-4">
              <textarea id="forumContent" class="w-full h-32 p-2 rounded-lg" placeholder="Chia s·∫ª c·∫£m x√∫c c·ªßa b·∫°n..." required></textarea>
              <input type="file" id="forumImage" accept="image/*" class="block w-full text-sm text-white file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-violet-700 hover:file:bg-violet-100" />
              <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-300" id="submitForum">ƒêƒÉng b√†i</button>
            </form>
          </div>
          
          <!-- Ph·∫ßn l·ªùi khuy√™n t·ª´ chuy√™n gia -->
          <div id="expertAdviceSection" class="bg-white bg-opacity-20 dark:bg-gray-700 dark:bg-opacity-30 rounded-lg p-6 advice-box fade-in">
            <h3 class="text-2xl font-bold mb-4 text-white flex items-center" id="expertAdviceTitle">
              <i class="fas fa-user-md advice-icon"></i> L·ªùi khuy√™n t·ª´ Chuy√™n gia
            </h3>
            <div id="expertAdviceContent" class="text-white mb-4"></div>
            <a href="#" id="expertAdviceLink" class="block mt-4 text-blue-300 hover:text-blue-400 flex items-center">
              <i class="fas fa-external-link-alt mr-2"></i> Xem th√™m l·ªùi khuy√™n
            </a>
          </div>

          
          <!-- Ph·∫ßn h√†nh ƒë·ªông ƒë·ªÅ xu·∫•t -->
          <div id="actionSection" class="bg-white bg-opacity-20 dark:bg-gray-700 dark:bg-opacity-30 rounded-lg p-6 advice-box fade-in">
            <h3 class="text-2xl font-bold mb-4 text-white flex items-center" id="actionTitle">
              <i class="fas fa-lightbulb advice-icon"></i> H√†nh ƒë·ªông ƒë·ªÅ xu·∫•t
            </h3>
            <ul id="actionList" class="list-disc list-inside text-white space-y-2">
              <!-- C√°c m·ª•c h√†nh ƒë·ªông -->
            </ul>
          </div>

          
          <!-- Ph·∫ßn podcast ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t -->
          <div id="podcastRecommendSection" class="bg-white bg-opacity-20 dark:bg-gray-700 dark:bg-opacity-30 rounded-lg p-6 advice-box fade-in">
            <h3 class="text-2xl font-bold mb-4 text-white flex items-center" id="podcastRecommendTitle">
              <i class="fas fa-podcast advice-icon"></i> Podcast ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t
            </h3>
            <div id="podcastContent" class="text-white mb-4"></div>
            <a href="#" id="podcastLink" class="block mt-4 text-blue-300 hover:text-blue-400 flex items-center">
              <i class="fas fa-external-link-alt mr-2"></i> Nghe podcast
            </a>
          </div>

          <!-- Khu v·ª±c chat -->
          <div id="chatSection" class="bg-white bg-opacity-20 dark:bg-gray-700 dark:bg-opacity-30 rounded-lg p-4 mt-4 md:col-span-2 md:p-6">
            <h3 class="text-2xl font-bold mb-4 text-white" id="chatTitle">Chuy√™n gia t∆∞ v·∫•n t√¢m l√Ω</h3>
            <div id="chatWindow" class="space-y-4 overflow-y-auto max-h-64 md:max-h-full p-2 bg-opacity-10 rounded-lg">
              <!-- Tin nh·∫Øn s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
            </div>            
            <form id="chatForm" class="mt-4 flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2">
              <input id="chatInput" type="text" class="w-full p-2 rounded-lg" placeholder="Nh·∫≠p tin nh·∫Øn c·ªßa b·∫°n..." required />
              <button type="submit" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-300">
                G·ª≠i
              </button>
            </form>            
          </div>

        </div>
      </main>
    
    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden">
      <div class="loader ease-linear rounded-full border-8 border-t-8 border-gray-200 h-16 w-16"></div>
    </div>
  
    <!-- C·∫£nh b√°o v√† t·ª´ ch·ªëi tr√°ch nhi·ªám -->
    <footer class="mt-8 text-center text-white text-sm">
        <p id="footerNote"><strong>L∆∞u √Ω:</strong> Trang web n√†y kh√¥ng thay th·∫ø cho t∆∞ v·∫•n chuy√™n nghi·ªáp. N·∫øu b·∫°n ƒëang g·∫∑p v·∫•n ƒë·ªÅ nghi√™m tr·ªçng v·ªÅ s·ª©c kh·ªèe t√¢m th·∫ßn, h√£y t√¨m ki·∫øm s·ª± gi√∫p ƒë·ª° t·ª´ chuy√™n gia.</p>
    </footer>
  
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        'use strict';

        // Bi·∫øn theo d√µi ng√¥n ng·ªØ hi·ªán t·∫°i
        let currentLanguage = "vi";

        // Bi·∫øn theo d√µi c·∫£m x√∫c hi·ªán t·∫°i
        let currentEmotion = '';

        // Bi·∫øn to√†n c·ª•c ƒë·ªÉ theo d√µi tr·∫°ng th√°i trang th∆∞ gi√£n
        let isRelaxing = false;

        // C√°c t·ª´ ng·ªØ trong ti·∫øng Anh
        const englishTexts = {
          pageTitle: "FOR YOU",
          howAreYouText: "How are you feeling today?",
          happyText: "Happy",
          sadText: "Sad",
          angryText: "Angry",
          scaredText: "Scared",
          stressedText: "Stressed",
          relaxText: "How about relaxing?",
          relaxTitle: "Close your eyes!",
          relaxDesc: "Relax with your favorite podcast, music, and books",
          backText: "Go back",
          musicTitle: "Listen to music",
          forumTitle: "Share with us",
          expertAdviceTitle: "Expert Advice",
          actionTitle: "Suggested Actions",
          podcastRecommendTitle: "Recommended Podcasts",
          chatTitle: "Psychological Counselor",
          submitForum: "Post",
          initialChat: "Hello! I'm your virtual assistant. Please share how you're feeling.",
          note: "<strong>Note:</strong> This website does not replace professional counseling. If you are experiencing serious mental health issues, please seek help from a professional.",
          advices: {
            happy: "Enjoy these positive feelings and share them with those around you. This is a good time to strengthen relationships and create lasting memories.",
            sad: "Feeling sad is normal, and it will pass. Allow yourself to feel this emotion but also seek support from friends and family.",
            angry: "When angry, pause and think before acting. Practice anger management techniques like deep breathing or counting down from 10.",
            scared: "Fear can make you feel powerless, but remember you are stronger than you think. Sharing your fear with others can help you see it from a different perspective.",
            stressed: "Chronic stress can affect your health. Identify the source of your stress and find ways to resolve it. Don't forget to take time for yourself and relax."
          },
          actions: {
            happy: [
              "Share your joy with a loved one",
              "Write down positive thoughts in your journal",
              "Engage in volunteer activities"
            ],
            sad: [
              "Practice 10 minutes of meditation",
              "Call a close friend",
              "Go for a walk in the park"
            ],
            angry: [
              "Count from 1 to 10 and take deep breaths",
              "Write down your thoughts",
              "Exercise for 15 minutes"
            ],
            scared: [
              "Practice 4-7-8 breathing technique",
              "Talk to someone you trust",
              "Visualize a safe and peaceful place"
            ],
            stressed: [
              "Perform muscle relaxation exercises",
              "Create a priority list for tasks",
              "Listen to relaxing music for 15 minutes"
            ]
          }
        };

        // C√°c t·ª´ ng·ªØ trong ti·∫øng Vi·ªát
        const vietnameseTexts = {
          pageTitle: "FOR YOU",
          howAreYouText: "H√¥m nay b·∫°n c·∫£m th·∫•y th·∫ø n√†o?",
          happyText: "Vui v·∫ª",
          sadText: "Bu·ªìn",
          angryText: "T·ª©c gi·∫≠n",
          scaredText: "S·ª£ h√£i",
          stressedText: "CƒÉng th·∫≥ng",
          relaxText: "Th∆∞ gi√£n ch√∫t kh√¥ng?",
          relaxTitle: "B·∫°n h√£y nh·∫Øm m·∫Øt l·∫°i!",
          relaxDesc: "Th∆∞ gi√£n v·ªõi podcast, nh·∫°c v√† s√°ch y√™u th√≠ch",
          backText: "Quay l·∫°i",
          musicTitle: "Nghe nh·∫°c n√®",
          forumTitle: "H√£y chia s·∫ª ƒë·∫øn ch√∫ng t√¥i",
          expertAdviceTitle: "L·ªùi khuy√™n t·ª´ Chuy√™n gia",
          actionTitle: "H√†nh ƒë·ªông ƒë·ªÅ xu·∫•t",
          podcastRecommendTitle: "Podcast ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t",
          chatTitle: "Chuy√™n gia t∆∞ v·∫•n t√¢m l√Ω",
          submitForum: "ƒêƒÉng b√†i",
          initialChat: "Xin ch√†o! T√¥i l√† tr·ª£ l√Ω ·∫£o. H√£y chia s·∫ª th√™m v·ªÅ c·∫£m x√∫c c·ªßa b·∫°n.",
          note: "<strong>L∆∞u √Ω:</strong> Trang web n√†y kh√¥ng thay th·∫ø cho t∆∞ v·∫•n chuy√™n nghi·ªáp. N·∫øu b·∫°n ƒëang g·∫∑p v·∫•n ƒë·ªÅ nghi√™m tr·ªçng v·ªÅ s·ª©c kh·ªèe t√¢m th·∫ßn, h√£y t√¨m ki·∫øm s·ª± gi√∫p ƒë·ª° t·ª´ chuy√™n gia.",
          advices: {
            happy: "H√£y t·∫≠n h∆∞·ªüng c·∫£m x√∫c t√≠ch c·ª±c n√†y v√† lan t·ªèa n√≥ ƒë·∫øn nh·ªØng ng∆∞·ªùi xung quanh. ƒê√¢y l√† c∆° h·ªôi t·ªët ƒë·ªÉ c·ªßng c·ªë c√°c m·ªëi quan h·ªá v√† t·∫°o ra nh·ªØng k·ª∑ ni·ªám ƒë·∫πp.",
            sad: "C·∫£m gi√°c bu·ªìn b√£ l√† b√¨nh th∆∞·ªùng v√† s·∫Ω qua ƒëi. H√£y cho ph√©p b·∫£n th√¢n c·∫£m nh·∫≠n c·∫£m x√∫c n√†y, nh∆∞ng ƒë·ªìng th·ªùi c≈©ng t√¨m ki·∫øm s·ª± h·ªó tr·ª£ t·ª´ ng∆∞·ªùi th√¢n v√† b·∫°n b√®.",
            angry: "Khi t·ª©c gi·∫≠n, h√£y t·∫°m d·ª´ng v√† suy nghƒ© tr∆∞·ªõc khi h√†nh ƒë·ªông. Th·ª±c h√†nh c√°c k·ªπ thu·∫≠t ki·ªÉm so√°t c∆°n gi·∫≠n nh∆∞ h√≠t th·ªü s√¢u ho·∫∑c ƒë·∫øm ng∆∞·ª£c t·ª´ 10 xu·ªëng 1.",
            scared: "N·ªói s·ª£ c√≥ th·ªÉ khi·∫øn ta c·∫£m th·∫•y b·∫•t l·ª±c, nh∆∞ng h√£y nh·ªõ r·∫±ng b·∫°n m·∫°nh m·∫Ω h∆°n b·∫°n nghƒ©. Chia s·∫ª n·ªói s·ª£ v·ªõi ng∆∞·ªùi kh√°c c√≥ th·ªÉ gi√∫p b·∫°n nh√¨n nh·∫≠n v·∫•n ƒë·ªÅ t·ª´ g√≥c ƒë·ªô kh√°c.",
            stressed: "Stress k√©o d√†i c√≥ th·ªÉ ·∫£nh h∆∞·ªüng ƒë·∫øn s·ª©c kh·ªèe. H√£y x√°c ƒë·ªãnh ngu·ªìn g·ªëc c·ªßa stress v√† t√¨m c√°ch gi·∫£i quy·∫øt. ƒê·ª´ng qu√™n d√†nh th·ªùi gian cho b·∫£n th√¢n v√† th∆∞ gi√£n."
          },
          actions: {
            happy: [
              "Chia s·∫ª ni·ªÅm vui v·ªõi ng∆∞·ªùi th√¢n",
              "Ghi l·∫°i nh·ªØng ƒëi·ªÅu t√≠ch c·ª±c trong nh·∫≠t k√Ω",
              "Tham gia ho·∫°t ƒë·ªông t√¨nh nguy·ªán"
            ],
            sad: [
              "Th·ª±c h√†nh thi·ªÅn ƒë·ªãnh 10 ph√∫t",
              "G·ªçi ƒëi·ªán cho ng∆∞·ªùi b·∫°n th√¢n",
              "ƒêi d·∫°o trong c√¥ng vi√™n"
            ],
            angry: [
              "ƒê·∫øm t·ª´ 1 ƒë·∫øn 10 v√† h√≠t th·ªü s√¢u",
              "Vi·∫øt ra nh·ªØng suy nghƒ© c·ªßa b·∫°n",
              "T·∫≠p th·ªÉ d·ª•c 15 ph√∫t"
            ],
            scared: [
              "Th·ª±c h√†nh k·ªπ thu·∫≠t th·ªü 4-7-8",
              "N√≥i chuy·ªán v·ªõi ng∆∞·ªùi b·∫°n tin t∆∞·ªüng",
              "T∆∞·ªüng t∆∞·ª£ng m·ªôt n∆°i an to√†n v√† b√¨nh y√™n"
            ],
            stressed: [
              "Th·ª±c hi·ªán b√†i t·∫≠p th∆∞ gi√£n c∆° b·∫Øp",
              "L·∫≠p danh s√°ch ∆∞u ti√™n c√¥ng vi·ªác",
              "Nghe nh·∫°c th∆∞ gi√£n 15 ph√∫t"
            ]
          }
        };

        // H√†m c·∫≠p nh·∫≠t relaxButton text
        function updateRelaxButtonText(language) {
          const relaxTextElement = document.getElementById('relaxText');
          if (isRelaxing) {
              relaxTextElement.textContent = language === "en" ? "Go back" : "Quay l·∫°i";
          } else {
              relaxTextElement.textContent = language === "en" ? "How about relaxing?" : "Th∆∞ gi√£n ch√∫t kh√¥ng?";
          }
        }

        // H√†m c·∫≠p nh·∫≠t n·ªôi dung d·ª±a tr√™n ng√¥n ng·ªØ
        function updateLanguage(language) {
          const texts = language === "en" ? englishTexts : vietnameseTexts;
          document.getElementById("pageTitle").textContent = texts.pageTitle;
          document.getElementById("howAreYouText").textContent = texts.howAreYouText;
          document.getElementById("happyText").textContent = texts.happyText;
          document.getElementById("sadText").textContent = texts.sadText;
          document.getElementById("angryText").textContent = texts.angryText;
          document.getElementById("scaredText").textContent = texts.scaredText;
          document.getElementById("stressedText").textContent = texts.stressedText;
          document.getElementById("relaxTitle").textContent = texts.relaxTitle;
          document.getElementById("relaxDesc").textContent = texts.relaxDesc;
          document.getElementById("backText").textContent = texts.backText;
          document.getElementById("musicTitle").textContent = texts.musicTitle;
          document.getElementById("forumTitle").textContent = texts.forumTitle;
          document.getElementById("expertAdviceTitle").textContent = texts.expertAdviceTitle;
          document.getElementById("actionTitle").textContent = texts.actionTitle;
          document.getElementById("podcastRecommendTitle").textContent = texts.podcastRecommendTitle;
          document.getElementById("chatTitle").textContent = texts.chatTitle;
          document.getElementById("submitForum").textContent = texts.submitForum;
          document.getElementById("footerNote").innerHTML = texts.note;

          // Update relaxButton text based on the current state
          updateRelaxButtonText(language);

          // C·∫≠p nh·∫≠t c√°c h√†nh ƒë·ªông v√† l·ªùi khuy√™n n·∫øu c√≥ c·∫£m x√∫c ƒëang ch·ªçn
          if (currentEmotion) {
              updateActionList(currentEmotion, texts.actions);
              updateExpertAdvice(currentEmotion, texts.advices);
              updatePodcastContent(currentEmotion);
              initChatWithAI(currentEmotion, texts.initialChat);
              
              // Th√™m d√≤ng n√†y ƒë·ªÉ c·∫≠p nh·∫≠t ti√™u ƒë·ªÅ c·∫£m x√∫c
              setEmoteTitle(currentEmotion);
          }
        }

        // X·ª≠ l√Ω s·ª± ki·ªán khi nh·∫•n n√∫t chuy·ªÉn ng√¥n ng·ªØ
        const langSwitch = document.getElementById("langSwitch");
        langSwitch.addEventListener("click", function () {
          currentLanguage = currentLanguage === "vi" ? "en" : "vi";
          updateLanguage(currentLanguage);
          this.textContent = currentLanguage === "vi" ? "English" : "Ti·∫øng Vi·ªát";

          // C·∫≠p nh·∫≠t n·ªôi dung n√∫t Dark Mode theo ng√¥n ng·ªØ
          const darkModeToggle = document.getElementById("darkModeToggle");
          darkModeToggle.textContent = darkModeToggle.textContent === "Dark Mode" || darkModeToggle.textContent === "Ch·∫ø ƒë·ªô t·ªëi"
            ? (currentLanguage === "vi" ? "Ch·∫ø ƒë·ªô m√†u s·∫Øc" : "Color Mode")
            : (currentLanguage === "vi" ? "Ch·∫ø ƒë·ªô t·ªëi" : "Dark Mode");
        });

        // Kh·ªüi t·∫°o v·ªõi ng√¥n ng·ªØ hi·ªán t·∫°i
        updateLanguage(currentLanguage);

        // Dark Mode Toggle
        const darkModeToggle = document.getElementById("darkModeToggle");

        // L·∫•y ch·∫ø ƒë·ªô t·ªëi t·ª´ localStorage n·∫øu c√≥
        let isDarkModeEnabled = localStorage.getItem("darkMode");

        // H√†m b·∫≠t/t·∫Øt ch·∫ø ƒë·ªô t·ªëi
        const enableDarkMode = () => {
          document.documentElement.classList.add("dark");
          localStorage.setItem("darkMode", "enabled");
        };

        const disableDarkMode = () => {
          document.documentElement.classList.remove("dark");
          localStorage.setItem("darkMode", "disabled");
        };

        // Ki·ªÉm tra n·∫øu ch·∫ø ƒë·ªô t·ªëi ƒë∆∞·ª£c b·∫≠t, √°p d·ª•ng
        if (isDarkModeEnabled === "enabled") {
          enableDarkMode();
          darkModeToggle.textContent = currentLanguage === "vi" ? "Ch·∫ø ƒë·ªô m√†u s·∫Øc" : "Color Mode";
        } else {
          darkModeToggle.textContent = currentLanguage === "vi" ? "Ch·∫ø ƒë·ªô t·ªëi" : "Dark Mode";
        }

        // Khi nh·∫•n v√†o n√∫t chuy·ªÉn ch·∫ø ƒë·ªô t·ªëi
        darkModeToggle.addEventListener("click", () => {
          isDarkModeEnabled = localStorage.getItem("darkMode");
          if (isDarkModeEnabled !== "enabled") {
            enableDarkMode();
            darkModeToggle.textContent = currentLanguage === "vi" ? "Ch·∫ø ƒë·ªô m√†u s·∫Øc" : "Color Mode";
          } else {
            disableDarkMode();
            darkModeToggle.textContent = currentLanguage === "vi" ? "Ch·∫ø ƒë·ªô t·ªëi" : "Dark Mode";
          }
        });

        // C√°c bi·∫øn to√†n c·ª•c
        const emoteButtons = document.querySelectorAll('.emote-btn');
        const emotePage = document.getElementById('emotePage');
        const emoteTitle = document.getElementById('emoteTitle');
        const backButton = document.getElementById('backButton');
        const expertAdviceContent = document.getElementById('expertAdviceContent');
        const expertAdviceLink = document.getElementById('expertAdviceLink');
        const podcastContent = document.getElementById('podcastContent');
        const podcastLink = document.getElementById('podcastLink');
        const actionList = document.getElementById('actionList');
        const chatForm = document.getElementById('chatForm');
        const chatInput = document.getElementById('chatInput');
        const chatWindow = document.getElementById('chatWindow');
        const relaxButton = document.getElementById('relaxButton');
        const relaxSection = document.getElementById('relaxSection');
        const howAreYouText = document.getElementById('howAreYouText');
        const podcastVideo = document.getElementById('podcastVideo');
        const podcastStopBtn = document.getElementById('podcastStopBtn');
        let chatHistory = [];

        // B·∫£n ƒë·ªì c·∫£m x√∫c v√† vƒÉn b·∫£n hi·ªÉn th·ªã
        const emoteTexts = {
          vi: {
            happy: 'vui v·∫ª',
            sad: 'bu·ªìn',
            angry: 't·ª©c gi·∫≠n',
            scared: 's·ª£ h√£i',
            stressed: 'cƒÉng th·∫≥ng'
          },
          en: {
            happy: 'happy',
            sad: 'sad',
            angry: 'angry',
            scared: 'scared',
            stressed: 'stressed'
          }
        };

        // H√†m hi·ªÉn th·ªã trang c·∫£m x√∫c
        emoteButtons.forEach(button => {
          button.addEventListener('click', () => {
            const emote = button.getAttribute('data-emote');
            console.log(`Emotion button clicked: ${emote}`);
            showEmotePage(emote);
          });
        });

        function showEmotePage(emote) {
          currentEmotion = emote;
          emoteButtons.forEach(button => button.classList.add('hidden'));
          emotePage.classList.remove('hidden');
          backButton.classList.remove('hidden');
          relaxButton.classList.add('hidden'); // ·∫®n n√∫t th∆∞ gi√£n ch√∫t kh√¥ng
          howAreYouText.classList.add('hidden'); // ·∫®n d√≤ng ch·ªØ "H√¥m nay b·∫°n c·∫£m th·∫•y th·∫ø n√†o?"
          setEmoteTitle(emote);
          console.log(`Showing emotePage for emotion: ${emote}`);

          // C·∫≠p nh·∫≠t n·ªôi dung d·ª±a tr√™n c·∫£m x√∫c
          const texts = currentLanguage === "en" ? englishTexts : vietnameseTexts;
          updateActionList(emote, texts.actions);
          updateExpertAdvice(emote, texts.advices);
          updatePodcastContent(emote);

          // Kh·ªüi t·∫°o cu·ªôc tr√≤ chuy·ªán v·ªõi AI
          initChatWithAI(emote, texts.initialChat);
        }

        function setEmoteTitle(emote) {
          emoteTitle.textContent = currentLanguage === "en" 
            ? `You are feeling ${emoteTexts.en[emote]}` 
            : `B·∫°n ƒëang c·∫£m th·∫•y ${emoteTexts.vi[emote]}`;
          console.log(`Set emoteTitle: ${emoteTitle.textContent}`);
        }

        // H√†m c·∫≠p nh·∫≠t danh s√°ch h√†nh ƒë·ªông
        function updateActionList(emote, actions) {
          actionList.innerHTML = actions[emote].map(action => `<li>${action}</li>`).join('');
          console.log(`Updated actionList for emotion: ${emote}`);
        }

        // H√†m c·∫≠p nh·∫≠t l·ªùi khuy√™n t·ª´ chuy√™n gia
        function updateExpertAdvice(emote, advices) {
          const advice = advices[emote];
          expertAdviceContent.textContent = advice;
          console.log(`Updated expertAdviceContent for emotion: ${emote}`);

          // C·∫≠p nh·∫≠t li√™n k·∫øt d·ª±a tr√™n c·∫£m x√∫c
          const adviceLinks = {
            happy: "https://www.thetimes.com/culture/books/article/how-be-happy-rules-advice-harvard-2023-dbw3lshff",
            sad: "https://www.psychologytoday.com/intl/blog/emotion-as-information/202011/how-to-release-sadness",
            angry: "https://www.mayoclinic.org/healthy-lifestyle/adult-health/in-depth/anger-management/art-20045434",
            scared: "https://www.mentalhealth.org.uk/explore-mental-health/publications/how-overcome-anxiety-and-fear",
            stressed: "https://www.mentalhealth.org.uk/explore-mental-health/publications/how-manage-and-reduce-stress"
          };

          expertAdviceLink.href = adviceLinks[emote];
          console.log(`Set expertAdviceLink.href: ${adviceLinks[emote]}`);
        }

        // H√†m c·∫≠p nh·∫≠t n·ªôi dung podcast
        function updatePodcastContent(emote) {
          const podcasts = {
            happy: "‚ÄòNi·ªÅm vui m·ªói ng√†y‚Äô - T·∫≠p m·ªõi nh·∫•t v·ªÅ c√°ch duy tr√¨ t√¢m tr·∫°ng t√≠ch c·ª±c",
            sad: "‚ÄòV∆∞·ª£t qua n·ªói bu·ªìn‚Äô - Chia s·∫ª t·ª´ nh·ªØng ng∆∞·ªùi ƒë√£ v∆∞·ª£t qua tr·∫ßm c·∫£m",
            angry: "‚ÄòKi·ªÉm so√°t c∆°n gi·∫≠n‚Äô - K·ªπ thu·∫≠t qu·∫£n l√Ω c·∫£m x√∫c hi·ªáu qu·∫£",
            scared: "‚Äòƒê·ªëi m·∫∑t v·ªõi n·ªói s·ª£‚Äô - C√¢u chuy·ªán truy·ªÅn c·∫£m h·ª©ng v·ªÅ v∆∞·ª£t qua phobia",
            stressed: "‚ÄòS·ªëng ch·∫≠m l·∫°i‚Äô - B√≠ quy·∫øt c√¢n b·∫±ng cu·ªôc s·ªëng trong th·∫ø gi·ªõi h·ªëi h·∫£"
          };

          podcastContent.textContent = podcasts[emote];
          podcastLink.href = "https://www.youtube.com/watch?v=bdK95yNhIP0";
          console.log(`Set podcastContent and podcastLink for emotion: ${emote}`);
        }

        // H√†m kh·ªüi t·∫°o cu·ªôc tr√≤ chuy·ªán v·ªõi AI
        function initChatWithAI(emote, initialChatMessage) {
          chatWindow.innerHTML = ''; // X√≥a n·ªôi dung chat tr∆∞·ªõc ƒë√≥
          chatHistory = []; // X√≥a l·ªãch s·ª≠ chat
          addChatBubbleWithTypingEffect(initialChatMessage, 'other');
          console.log(`Initialized chat with AI for emotion: ${emote}`);
        }

        // X·ª≠ l√Ω s·ª± ki·ªán g·ª≠i tin nh·∫Øn
        chatForm.addEventListener('submit', function(e) {
          e.preventDefault();
          const message = chatInput.value.trim();
          if (message !== '') {
            addChatBubble(message, 'self');
            chatInput.value = '';
            generateAIResponse(message);
            console.log(`User sent message: ${message}`);
          }
        });

        // H√†m th√™m tin nh·∫Øn v√†o khung chat (hi·ªÉn th·ªã tr·ª±c ti·∫øp kh√¥ng c√≥ hi·ªáu ·ª©ng g√µ ph√≠m)
        function addChatBubble(message, type) {
          const bubble = document.createElement('div');
          bubble.classList.add('chat-bubble', `chat-bubble-${type}`, 'p-4', 'rounded-xl', 'max-w-xs', 'text-white', 'transition-all', 'duration-300', 'transform', 'hover:scale-105');
          
          if (type === 'self') {
            bubble.classList.add('chat-bubble-self');
          } else {
            bubble.classList.add('chat-bubble-other');
          }

          bubble.textContent = message;
          chatWindow.appendChild(bubble);
          chatWindow.scrollTop = chatWindow.scrollHeight;
          console.log(`Added chat bubble (${type}): ${message}`);
        }

        // H√†m th√™m tin nh·∫Øn v√†o khung chat v·ªõi hi·ªáu ·ª©ng g√µ ph√≠m
        function addChatBubbleWithTypingEffect(message, type, delay = 50) {
          const bubble = document.createElement('div');
          bubble.classList.add('chat-bubble', `chat-bubble-${type}`, 'p-4', 'rounded-xl', 'max-w-xs', 'text-white', 'transition-all', 'duration-300', 'transform', 'hover:scale-105');
          
          if (type === 'self') {
            bubble.classList.add('chat-bubble-self');
          } else {
            bubble.classList.add('chat-bubble-other');
          }

          chatWindow.appendChild(bubble);
          chatWindow.scrollTop = chatWindow.scrollHeight;

          // Hi·ªÉn th·ªã t·ª´ng k√Ω t·ª± v·ªõi ƒë·ªô tr·ªÖ
          let index = 0;
          const typingInterval = setInterval(() => {
            bubble.textContent += message[index];
            index++;
            chatWindow.scrollTop = chatWindow.scrollHeight;  // Cu·ªôn xu·ªëng cu·ªëi c√πng ƒë·ªÉ xem tin nh·∫Øn
            if (index === message.length) {
              clearInterval(typingInterval);  // D·ª´ng khi ƒë√£ ho√†n th√†nh
              console.log(`Finished typing message (${type}): ${message}`);
            }
          }, delay);
        }

        // H√†m t·∫°o ph·∫£n h·ªìi t·ª´ AI
        async function generateAIResponse(userMessage) {
        try {
            showLoadingSpinner(); // Hi·ªÉn th·ªã bi·ªÉu t∆∞·ª£ng t·∫£i
            console.log(`Generating AI response for message: ${userMessage}`);

            // Chuy·ªÉn ƒë·ªïi tin nh·∫Øn ng∆∞·ªùi d√πng v·ªÅ ch·ªØ th∆∞·ªùng ƒë·ªÉ ki·ªÉm tra kh√¥ng ph√¢n bi·ªát hoa th∆∞·ªùng
            const lowerCaseMessage = userMessage.toLowerCase();

            // Danh s√°ch c√°c c√¢u h·ªèi ƒë·∫∑c bi·ªát
            const specialQuestions = [
            "ai l√† ch·ªß c·ªßa b·∫°n",
            "ai ƒë√£ t·∫°o ra b·∫°n",
            "who is your owner",
            "who created you",
            "ch·ªß c·ªßa b·∫°n l√† ai"
            ];

            // Ki·ªÉm tra xem tin nh·∫Øn c√≥ ch·ª©a c√¢u h·ªèi ƒë·∫∑c bi·ªát kh√¥ng
            const isSpecialQuestion = specialQuestions.some(question =>
            lowerCaseMessage.includes(question)
            );

            if (isSpecialQuestion) {
            const specialReply = "Tan Tai - RAP001 - K49 UEH";
            addChatBubbleWithTypingEffect(specialReply, 'other');
            console.log(`AI replied: ${specialReply}`);
            hideLoadingSpinner(); // ·∫®n bi·ªÉu t∆∞·ª£ng t·∫£i
            return; // K·∫øt th√∫c h√†m ƒë·ªÉ kh√¥ng g·ªçi API
            }

            // G·ªçi API nh∆∞ b√¨nh th∆∞·ªùng n·∫øu kh√¥ng c√≥ c√¢u h·ªèi ƒë·∫∑c bi·ªát
            const response = await fetch('http://localhost:5000/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                message: userMessage,
                emotion: currentEmotion // G·ª≠i c·∫£m x√∫c hi·ªán t·∫°i
            })
            });

            hideLoadingSpinner(); // ·∫®n bi·ªÉu t∆∞·ª£ng t·∫£i
            console.log(`Received response from AI`);

            const data = await response.json();
            if (data.reply) {
            addChatBubbleWithTypingEffect(data.reply, 'other');
            console.log(`AI replied: ${data.reply}`);
            } else {
            const fallbackMessage = currentLanguage === "en" 
                ? 'Sorry, something went wrong. Please try again later.' 
                : 'Xin l·ªói, c√≥ l·ªói x·∫£y ra. Vui l√≤ng th·ª≠ l·∫°i sau.';
            addChatBubbleWithTypingEffect(fallbackMessage, 'other');
            console.log(`AI fallback message: ${fallbackMessage}`);
            }
        } catch (error) {
            console.error(error);
            hideLoadingSpinner(); // ·∫®n bi·ªÉu t∆∞·ª£ng t·∫£i
            const errorMessage = currentLanguage === "en" 
            ? 'Sorry, unable to connect to the server.' 
            : 'Xin l·ªói, kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn m√°y ch·ªß.';
            addChatBubbleWithTypingEffect(errorMessage, 'other');
            console.log(`AI error message: ${errorMessage}`);
        }
        }

        // Th√™m tin nh·∫Øn ch√†o m·ª´ng khi ng∆∞·ªùi d√πng v·ª´a v√†o trang
        window.addEventListener('load', function() {
          const initialMessage = currentLanguage === "en" 
            ? englishTexts.initialChat 
            : vietnameseTexts.initialChat;
          addChatBubbleWithTypingEffect(initialMessage, 'other');
          console.log(`Added initial chat message: ${initialMessage}`);
        });

        // H√†m hi·ªÉn th·ªã bi·ªÉu t∆∞·ª£ng t·∫£i
        function showLoadingSpinner() {
          document.getElementById('loadingSpinner').classList.remove('hidden');
          console.log(`Loading spinner shown`);
        }

        // H√†m ·∫©n bi·ªÉu t∆∞·ª£ng t·∫£i
        function hideLoadingSpinner() {
          document.getElementById('loadingSpinner').classList.add('hidden');
          console.log(`Loading spinner hidden`);
        }

        // X·ª≠ l√Ω n√∫t "Quay l·∫°i" trong trang c·∫£m x√∫c
        backButton.addEventListener('click', () => {
          emoteButtons.forEach(button => button.classList.remove('hidden'));
          emotePage.classList.add('hidden');
          backButton.classList.add('hidden');
          relaxButton.classList.remove('hidden'); // Hi·ªÉn th·ªã l·∫°i n√∫t th∆∞ gi√£n ch√∫t kh√¥ng
          howAreYouText.classList.remove('hidden'); // Hi·ªÉn th·ªã l·∫°i d√≤ng ch·ªØ "H√¥m nay b·∫°n c·∫£m th·∫•y th·∫ø n√†o?"
          localStorage.removeItem('chatHistory'); // X√≥a l·ªãch s·ª≠ chat khi quay l·∫°i
          console.log(`Back button clicked - Returning to main page`);
        });

        // X·ª≠ l√Ω n√∫t "Th∆∞ gi√£n ch√∫t kh√¥ng?" ƒë·ªïi th√†nh "Quay l·∫°i" khi ng∆∞·ªùi d√πng v√†o trang th∆∞ gi√£n
        relaxButton.addEventListener('click', function() {
          relaxSection.classList.toggle('hidden');
          emoteButtons.forEach(button => button.classList.toggle('hidden'));
          howAreYouText.classList.toggle('hidden');
          console.log(`Relax button clicked - Toggling relaxSection`);

          // Thay ƒë·ªïi tr·∫°ng th√°i n√∫t
          if (isRelaxing) {
            document.getElementById('relaxText').textContent = currentLanguage === "en" ? "How about relaxing?" : "Th∆∞ gi√£n ch√∫t kh√¥ng?";
            isRelaxing = false;
            console.log(`Set relaxButton text to: ${document.getElementById('relaxText').textContent}`);
          } else {
            document.getElementById('relaxText').textContent = currentLanguage === "en" ? "Go back" : "Quay l·∫°i";
            isRelaxing = true;
            backButton.classList.add('hidden'); // ·∫®n n√∫t quay l·∫°i khi ·ªü trang th∆∞ gi√£n
            console.log(`Set relaxButton text to: ${document.getElementById('relaxText').textContent}`);
          }
        });

        // X·ª≠ l√Ω g·ª≠i b√†i vi·∫øt tr√™n di·ªÖn ƒë√†n
        const forumForm = document.getElementById('forumForm');
        forumForm.addEventListener('submit', function(e) {
          e.preventDefault();
          showLoadingSpinner(); // Hi·ªÉn th·ªã bi·ªÉu t∆∞·ª£ng t·∫£i
          console.log(`Forum form submitted`);
          setTimeout(() => {
            hideLoadingSpinner(); // ·∫®n bi·ªÉu t∆∞·ª£ng t·∫£i
            const successMessage = currentLanguage === "en" 
              ? 'Your post has been successfully submitted!' 
              : 'B√†i vi·∫øt c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c ƒëƒÉng th√†nh c√¥ng!';
            alert(successMessage);
            forumForm.reset();
            console.log(`Forum form reset and success message shown`);
          }, 1000);
        });

        // H·ªó tr·ª£ emoji trong khung chat
        chatInput.addEventListener('input', function() {
          // Thay th·∫ø k√Ω hi·ªáu b·∫±ng emoji
          const emojiMap = {
            ':)': 'üòä',
            ':(': 'üò¢',
            ':D': 'üòÑ',
            '<3': '‚ù§Ô∏è'
          };
          for (const [key, value] of Object.entries(emojiMap)) {
            this.value = this.value.replace(new RegExp(`\\${key}`, 'g'), value);
          }
          console.log(`Chat input updated with emojis`);
        });

        // X·ª≠ l√Ω n√∫t d·ª´ng/ph√°t podcast
        podcastStopBtn.addEventListener('click', () => {
          if (podcastVideo.paused) {
            podcastVideo.play();
            podcastStopBtn.innerHTML = '<i class="fas fa-pause"></i>';
            console.log(`Podcast video played`);
          } else {
            podcastVideo.pause();
            podcastStopBtn.innerHTML = '<i class="fas fa-play"></i>';
            console.log(`Podcast video paused`);
          }
        });

      });
    </script>
</body>
</html>
